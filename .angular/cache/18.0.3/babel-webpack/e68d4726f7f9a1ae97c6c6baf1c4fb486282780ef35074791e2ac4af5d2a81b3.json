{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { of } from 'rxjs';\nimport { map, catchError } from 'rxjs/operators';\nlet AdminPage = class AdminPage {\n  constructor(firebaseService) {\n    this.firebaseService = firebaseService;\n    this.reservas$ = of([]);\n    this.reservasAgrupadas = {};\n    this.horarios = ['18:30', '19:00', '19:30', '20:00', '20:30', '21:00', '21:30'];\n    this.diasDisponiveis = [];\n    this.diaSelecionado = null;\n    this.horarioSelecionado = null;\n  }\n  ngOnInit() {\n    this.firebaseService.deleteExpiredReservas().then(() => {\n      this.reservas$ = this.firebaseService.getReservas().pipe(map(actions => {\n        const reservas = actions.map(a => {\n          const data = a.payload.doc.data();\n          const id = a.payload.doc.id;\n          return {\n            id,\n            ...data\n          };\n        });\n        this.diasDisponiveis = [...new Set(reservas.map(reserva => reserva.data))].sort();\n        this.agruparReservasPorDiaEHorario(reservas);\n        return reservas;\n      }), catchError(error => {\n        console.error('Erro ao carregar reservas: ', error);\n        return of([]);\n      }));\n    }).catch(error => {\n      console.error('Erro ao deletar reservas expiradas: ', error);\n    });\n  }\n  agruparReservasPorDiaEHorario(reservas) {\n    this.reservasAgrupadas = reservas.reduce((acc, reserva) => {\n      const {\n        data,\n        horario\n      } = reserva;\n      if (!acc[data]) acc[data] = {};\n      if (!acc[data][horario]) acc[data][horario] = [];\n      acc[data][horario].push(reserva);\n      return acc;\n    }, {});\n  }\n  selecionarDia(dia) {\n    this.diaSelecionado = dia;\n    this.horarioSelecionado = null;\n  }\n  toggleReservas(horario) {\n    this.horarioSelecionado = this.horarioSelecionado === horario ? null : horario;\n  }\n  isReservasVisiveis(horario) {\n    return this.horarioSelecionado === horario;\n  }\n};\nAdminPage = __decorate([Component({\n  selector: 'app-admin',\n  templateUrl: './admin.page.html',\n  styleUrls: ['./admin.page.scss']\n})], AdminPage);\nexport { AdminPage };","map":{"version":3,"names":["Component","of","map","catchError","AdminPage","constructor","firebaseService","reservas$","reservasAgrupadas","horarios","diasDisponiveis","diaSelecionado","horarioSelecionado","ngOnInit","deleteExpiredReservas","then","getReservas","pipe","actions","reservas","a","data","payload","doc","id","Set","reserva","sort","agruparReservasPorDiaEHorario","error","console","catch","reduce","acc","horario","push","selecionarDia","dia","toggleReservas","isReservasVisiveis","__decorate","selector","templateUrl","styleUrls"],"sources":["C:\\Users\\Aluno\\Desktop\\Nova pasta\\integrador_2024\\src\\app\\firebase.service.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { FirebaseService } from '../../firebase.service';\r\nimport { Observable, of } from 'rxjs';\r\nimport { map, catchError } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-admin',\r\n  templateUrl: './admin.page.html',\r\n  styleUrls: ['./admin.page.scss'],\r\n})\r\nexport class AdminPage implements OnInit {\r\n\r\n  reservas$: Observable<any[]> = of([]);\r\n  reservasAgrupadas: { [key: string]: any } = {};\r\n  horarios: string[] = ['18:30', '19:00', '19:30', '20:00', '20:30', '21:00', '21:30'];\r\n  diasDisponiveis: string[] = [];\r\n  diaSelecionado: string | null = null;\r\n  horarioSelecionado: string | null = null;\r\n\r\n  constructor(private firebaseService: FirebaseService) {}\r\n\r\n  ngOnInit() {\r\n    this.firebaseService.deleteExpiredReservas().then(() => {\r\n      this.reservas$ = this.firebaseService.getReservas().pipe(\r\n        map(actions => {\r\n          const reservas = actions.map(a => {\r\n            const data = a.payload.doc.data() as any;\r\n            const id = a.payload.doc.id;\r\n            return { id, ...data };\r\n          });\r\n          this.diasDisponiveis = [...new Set(reservas.map(reserva => reserva.data))].sort();\r\n          this.agruparReservasPorDiaEHorario(reservas);\r\n          return reservas;\r\n        }),\r\n        catchError(error => {\r\n          console.error('Erro ao carregar reservas: ', error);\r\n          return of([]);\r\n        })\r\n      );\r\n    }).catch(error => {\r\n      console.error('Erro ao deletar reservas expiradas: ', error);\r\n    });\r\n  }\r\n\r\n  agruparReservasPorDiaEHorario(reservas: any[]) {\r\n    this.reservasAgrupadas = reservas.reduce((acc, reserva) => {\r\n      const { data, horario } = reserva;\r\n      if (!acc[data]) acc[data] = {};\r\n      if (!acc[data][horario]) acc[data][horario] = [];\r\n      acc[data][horario].push(reserva);\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  selecionarDia(dia: string) {\r\n    this.diaSelecionado = dia;\r\n    this.horarioSelecionado = null;\r\n  }\r\n\r\n  toggleReservas(horario: string) {\r\n    this.horarioSelecionado = this.horarioSelecionado === horario ? null : horario;\r\n  }\r\n\r\n  isReservasVisiveis(horario: string): boolean {\r\n    return this.horarioSelecionado === horario;\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}